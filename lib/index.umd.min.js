(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define("SuperFrom",[],e):"object"===typeof exports?exports["SuperFrom"]=e():t["SuperFrom"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({2470:function(t,e,n){"use strict";var i=n("5341"),r=n.n(i);r.a},"3ad9":function(t,e,n){"use strict";var i=n("41f0"),r=n.n(i);r.a},"41f0":function(t,e,n){},5341:function(t,e,n){},"5fa5":function(t,e,n){},"7e2d":function(t,e,n){"use strict";var i=n("5fa5"),r=n.n(i);r.a},8875:function(t,e,n){var i,r,o;(function(n,s){r=[],i=s,o="function"===typeof i?i.apply(e,r):i,void 0===o||(t.exports=o)})("undefined"!==typeof self&&self,(function(){function t(){if(document.currentScript)return document.currentScript;try{throw new Error}catch(h){var t,e,n,i=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,o=i.exec(h.stack)||r.exec(h.stack),s=o&&o[1]||!1,a=o&&o[2]||!1,u=document.location.href.replace(document.location.hash,""),c=document.getElementsByTagName("script");s===u&&(t=document.documentElement.outerHTML,e=new RegExp("(?:[^\\n]+?\\n){0,"+(a-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),n=t.replace(e,"$1").trim());for(var l=0;l<c.length;l++){if("interactive"===c[l].readyState)return c[l];if(c[l].src===s)return c[l];if(s===u&&c[l].innerHTML&&c[l].innerHTML.trim()===n)return c[l]}return null}}return t}))},a733:function(t,e,n){},b8fb:function(t,e,n){"use strict";var i=n("a733"),r=n.n(i);r.a},fb15:function(t,e,n){"use strict";if(n.r(e),"undefined"!==typeof window){var i=window.document.currentScript,r=n("8875");i=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var o=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"super-flow"},[n("div",{ref:"flow-canvas",style:{width:t.width+"px",height:t.height+"px"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.contextmenu(e)}}},[t.temEdgeConf.visible?n("graph-line",{attrs:{graph:t.graph,link:t.temEdgeConf.link}}):t._e(),t._l(t.graph.linkList,(function(e,i){return n("graph-line",{key:e.key,attrs:{graph:t.graph,link:e}})})),t._l(t.graph.nodeList,(function(e,i){return n("graph-node",{key:e.key,attrs:{index:i,node:e,graph:t.graph,"is-move":e===t.moveNodeConf.node,"is-tem-edge":t.temEdgeConf.visible,"node-intercept":t.nodeIntercept(e)},on:{"node-mousedown":t.nodeMousedown,"node-mouseenter":t.nodeMouseenter,"node-mouseleave":t.nodeMouseleave,"node-mouseup":t.nodeMouseup,"side-mousedown":t.sideMousedown,"node-contextmenu":t.nodeContextmenu},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.meta;return[t._t("node",null,{meta:n})]}}],null,!0)})})),n("graph-menu",{attrs:{visible:t.menuConf.visible,graph:t.graph,position:t.menuConf.position,list:t.menuConf.list,source:t.menuConf.source},on:{"update:visible":function(e){return t.$set(t.menuConf,"visible",e)}},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.item;return[t._t("menuItem",null,{item:n})]}}],null,!0)}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.graph.graphSelected,expression:"graph.graphSelected"}],ref:"selectAllMask",staticClass:"select-all__mask",style:t.maskStyle,attrs:{tabindex:"-1"},on:{blur:function(e){t.graph.graphSelected=!1},mousedown:t.selectAllMaskMouseDown,contextmenu:function(t){t.preventDefault(),t.stopPropagation()}}})],2)])},a=[];function u(t){return f(t)||h(t)||l(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){if(t){if("string"===typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function h(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function f(t){if(Array.isArray(t))return d(t)}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function v(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}var y,g=function(){function t(){p(this,t),this.listeners={}}return v(t,[{key:"add",value:function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"remove",value:function(t,e){if(t in this.listeners)for(var n=this.listeners[t],i=0,r=n.length;i<r;i++)if(n[i]===e)return n.splice(i,1),this.remove(t,e)}},{key:"dispatch",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.type in this.listeners){var i=this.listeners[t.type];t.target=this,n?i.some((function(n,r){var o=n.call(e,t);return o&&i.unshift.apply(i,u(i.splice(r,1))),o})):i.forEach((function(n){return n.call(e,t)}))}}}]),t}();function b(t){return M(t)||A(t)||k(t)||w()}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(t,e){if(t){if("string"===typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}function A(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function M(t){if(Array.isArray(t))return x(t)}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function L(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=n.length,r=[],o=16,s=0;s<o;s++)r[s]=n[0|Math.random()*i];return t+r.join("")+e}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t.clientX,i=t.clientY,r=t.currentTarget,o=e||r,s=o.getBoundingClientRect(),a=s.left,u=s.top;return[n-a,i-u]}function S(t,e){return[t[0]+e[0],t[1]+e[1]]}function O(t,e){return[t[0]*e,t[1]*e]}function _(t,e){return[e[0]-t[0],e[1]-t[1]]}function j(t,e){return[t[0]-e[0],t[1]-e[1]]}function P(t,e){return t[0]*e[0]+t[1]*e[1]}function I(t,e){return t[0]*e[1]-t[1]*e[0]}function E(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function $(t,e){return t[0]===e[0]&&t[1]===e[1]}function N(t){return Math.round(180/Math.PI*Math.atan2(t[1],t[0]))+180}function T(t,e){return t[0]*e[1]-t[1]*e[0]===0}function D(t){var e={add:S,multiply:O,differ:_,minus:j,dotProduct:P,cross:I,unitVector:E,equals:$,angle:N,parallel:T},n={};return Object.keys(e).forEach((function(i){Object.defineProperty(n,i,{get:function(){return function(r){return t=e[i](t,r),n}}})})),Object.defineProperty(n,"end",{get:function(){return t}}),n}function R(t){return Object.prototype.toString.call(t).slice(8,-1).toLocaleLowerCase()}function F(t){return"function"===R(t)}function X(t){return"boolean"===R(t)}function B(t,e){t.splice.apply(t,[0,t.length].concat(b(e)))}function Y(t,e){var n=null;return function(){n&&clearTimeout(n),n=setTimeout(t,e)}}function U(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var G={top:1,right:2,bottom:3,left:4},z=(y={},U(y,G.top,[0,-1]),U(y,G.right,[1,0]),U(y,G.bottom,[0,1]),U(y,G.left,[-1,0]),y);function H(t){return q(t)||W(t)||V(t)||J()}function J(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(t,e){if(t){if("string"===typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(t,e):void 0}}function W(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function q(t){if(Array.isArray(t))return K(t)}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function tt(t,e,n){return e&&Z(t.prototype,e),n&&Z(t,n),t}var et=function(){function t(e,n){Q(this,t);var i=e.id,r=void 0===i?L("node"):i,o=e.width,s=void 0===o?180:o,a=e.height,u=void 0===a?100:a,c=e.coordinate,l=void 0===c?[0,0]:c,h=e.meta,f=void 0===h?null:h,d=e.vertex,p=void 0===d?0:d;this.depth=0,this.key=L("node"),this.graph=n,this.id=r,this.coordinate=H(l),this.meta=f,this.vertex=p,this.width=s,this.height=u}return tt(t,[{key:"angle",value:function(){var t=this.width/2,e=this.height/2,n=[0,0],i=D(n).minus([t,e]).angle().end,r=D(n).add([t,0]).minus([0,e]).angle().end,o=D(n).add([t,e]).angle().end,s=D(n).add([0,e]).minus([t,0]).angle().end;this.angleList=[i,r,o,s]}},{key:"relative",value:function(t){var e=D(t).minus([this.width/2,this.height/2]).angle().end,n=this.angleList,i=[G.top,G.right,G.bottom,G.left],r=G.left;return n.reduce((function(t,n,o){return e>=t&&e<n&&(r=i[o-1]),n})),{position:this.fixOffset(t,r),direction:z[r]}}},{key:"fixOffset",value:function(t,e){switch(e){case G.top:t[1]=0;break;case G.right:t[0]=this.width;break;case G.bottom:t[1]=this.height;break;case G.left:default:t[0]=0;break}return t}},{key:"remove",value:function(){this.graph.removeNode(this)}},{key:"getInterface",value:function(){return{width:this.width,height:this.height,coordinate:H(this.coordinate),meta:this.meta,remove:this.remove.bind(this)}}},{key:"vertex",set:function(t){t&&(this.graph.vertex=this)},get:function(){return this.graph.vertex===this?1:0}},{key:"position",get:function(){return D(this.coordinate).add(this.graph.origin).end},set:function(t){this.coordinate=D(t).minus(this.graph.origin).end}},{key:"center",get:function(){return D(this.coordinate).add([this.width/2,this.height/2]).end},set:function(t){this.coordinate=D(t).minus([this.width/2,this.height/2]).end}},{key:"width",get:function(){return this._width},set:function(t){t=Math.floor(t),this._width=t>50?t:50,this.angle()}},{key:"height",get:function(){return this._height},set:function(t){t=Math.floor(t),this._height=t>50?t:50,this.angle()}}]),t}();function nt(t){return ot(t)||rt(t)||ut(t)||it()}function it(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rt(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ot(t){if(Array.isArray(t))return ct(t)}function st(t,e){return ht(t)||lt(t,e)||ut(t,e)||at()}function at(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ut(t,e){if(t){if("string"===typeof t)return ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(t,e):void 0}}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function lt(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)if(n.push(s.value),e&&n.length===e)break}catch(u){r=!0,o=u}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function ht(t){if(Array.isArray(t))return t}function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pt(t,e,n){return e&&dt(t.prototype,e),n&&dt(t,n),t}function mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vt=function(){function t(e,n){ft(this,t);var i=e.id,r=void 0===i?L("link"):i,o=e.start,s=e.end,a=void 0===s?null:s,u=e.startAt,c=void 0===u?[0,0]:u,l=e.endAt,h=void 0===l?[0,0]:l,f=e.meta,d=void 0===f?null:f;this.key=L("link"),this.id=r,this.graph=n,this.start=o,this.meta=d,this.end=a,this.startDirection=z[G.top],this.endDirection=z[G.top],this.startAt=c,this.endAt=h}return pt(t,[{key:"startCoordinate",value:function(){return D(this.start.position).add(this.startAt).end}},{key:"endCoordinate",value:function(){return this.end?D(this.end.position).add(this.endAt).end:this.movePosition}},{key:"coordinateList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,n=this.startCoordinate(),i=this.endCoordinate(),r=this.startDirection,o=this.endDirection,s=D(r).multiply(t.distance).add(n).end,a=D(o).multiply(t.distance).add(i).end;o=D(o).multiply(-1).end;var u=[a[0]-s[0],0],c=[0,a[1]-s[1]],l=this.pathDirection(c,u,r),h=this.pathDirection(c,u,o),f=D(l).dotProduct(h).end>0?2:1,d=h===u?c:u,p=[];if(p.push(n,s),1===f){var m=D(s).add(l).end,v=D(m).add(h).end;p.push(m,v)}else{var y=D(l).multiply(e).add(s).end,g=D(y).add(d).end,b=D(h).multiply(1-e).add(g).end;p.push(y,g,b)}return p.push(i),p}},{key:"pathDirection",value:function(t,e,n){return D(e).parallel(n).end?D(e).dotProduct(n).end>0?e:t:D(t).dotProduct(n).end>0?t:e}},{key:"isPointInLink",value:function(t){var e=this.pathPointList,n=e.pointList,i=e.minX,r=e.minY,o=e.maxX,s=e.maxY,a=5;if(t[0]<i-a||t[0]>o+a||t[1]<r-a||t[1]>s+a)return!1;for(var u=0;u<n.length-2;u++){var c=n[u],l=n[u+1],h=Math.min(c[1],l[1])-a,f=Math.max(c[0],l[0])+a,d=Math.max(c[1],l[1])+a,p=Math.min(c[0],l[0])-a,m=st(t,2),v=m[0],y=m[1];if(v>p&&v<f&&y>h&&y<d)return!0}return!1}},{key:"remove",value:function(){this.graph.removeLink(this)}},{key:"getInterface",value:function(){return{meta:this.meta,remove:this.remove.bind(this),start:this.start.getInterface(),end:this.end.getInterface(),startAt:nt(this.startAt),endAt:nt(this.endAt)}}},{key:"end",get:function(){return this._end},set:function(t){if(this.start===t)return!1;this._end=t}},{key:"startAt",get:function(){return this._startAt},set:function(t){var e=this.start.relative(t);this._startAt=e.position,this.startDirection=e.direction}},{key:"endAt",get:function(){return this._endAt},set:function(t){if(this.end){var e=this.end.relative(t);this._endAt=e.position,this.endDirection=e.direction}else this._endAt=t}},{key:"movePosition",get:function(){return this._movePosition},set:function(t){if(this._movePosition=t,!this.end){var e=this.start.relative(D(t).minus(this.graph.origin).minus(this.start.coordinate).end);this.endDirection=D(e.direction).multiply(-1).end}}},{key:"pathPointList",get:function(){var t=this.coordinateList(),e=[],n=[];return t.forEach((function(t){e.push(t[0]),n.push(t[1])})),{pointList:t,xList:e,yList:n,minX:Math.min.apply(Math,e),maxX:Math.max.apply(Math,e),minY:Math.min.apply(Math,n),maxY:Math.max.apply(Math,n)}}}]),t}();function yt(t){return yt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function gt(t){return kt(t)||wt(t)||xt(t)||bt()}function bt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wt(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function kt(t){if(Array.isArray(t))return Lt(t)}function At(t,e){return St(t)||Ct(t,e)||xt(t,e)||Mt()}function Mt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xt(t,e){if(t){if("string"===typeof t)return Lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lt(t,e):void 0}}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ct(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)if(n.push(s.value),e&&n.length===e)break}catch(u){r=!0,o=u}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function St(t){if(Array.isArray(t))return t}function Ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jt(t,e,n){return e&&_t(t.prototype,e),n&&_t(t,n),t}function Pt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}function It(t,e){return It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},It(t,e)}function Et(t){var e=Tt();return function(){var n,i=Dt(t);if(e){var r=Dt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return $t(this,n)}}function $t(t,e){return!e||"object"!==yt(e)&&"function"!==typeof e?Nt(t):e}function Nt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Dt(t){return Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Dt(t)}mt(vt,"distance",15);var Rt=function(t){Pt(n,t);var e=Et(n);function n(t){var i;Ot(this,n);var r=t.nodeList,o=void 0===r?[]:r,s=t.linkList,a=void 0===s?[]:s,u=t.width,c=t.height,l=t.origin,h=void 0===l?null:l;return i=e.call(this),i.nodeList=[],i.linkList=[],i.width=u,i.height=c,i.origin=h||[Math.floor(u/2),Math.floor(c/2)],i.mouseonLink=null,i.mouseonNode=null,i.graphSelected=!1,i.maskBoundingClientRect={},i.vertex=null,i.initNode(o),i.initLink(a),i}return jt(n,[{key:"pointMap",value:function(){var t={};return this.nodeList.forEach((function(e){t[e.id]=e})),t}},{key:"initNode",value:function(t){var e=this;B(this.nodeList,t.map((function(t){return e.createNode(t)})))}},{key:"initLink",value:function(t){var e=this,n=[];t.forEach((function(t){var i=t.startId,r=void 0===i?"":i,o=t.endId,s=void 0===o?"":o,a=t.startAt,u=void 0===a?[0,0]:a,c=t.endAt,l=void 0===c?[0,0]:c,h=t.meta,f=void 0===h?null:h,d=e.pointMap(),p=d[r],m=d[s];p&&m&&n.push(e.createLink({start:p,end:m,meta:f,startAt:u,endAt:l}))})),B(this.linkList,n)}},{key:"createNode",value:function(t){return new et(t,this)}},{key:"createLink",value:function(t){return new vt(t,this)}},{key:"insetGrouping",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[],i=function n(i){t.linkList.forEach((function(t,r){var o=t.start,s=t.end;o===i&&(s.depth=i.depth+1,e?(t.startAt=[o.width,Math.ceil(o.height/2)],t.endAt=[0,Math.ceil(s.height/2)]):(t.startAt=[Math.ceil(o.width/2),o.height],t.endAt=[Math.ceil(s.width/2),0]),n(t.end))}))},r=function(t,e){var i=n[t];i?i.add(e):n[t]=new Set([e])};return i(this.vertex),r(0,this.vertex),this.nodeList.forEach((function(t){return r(t.depth,t)})),n}},{key:"vertical",value:function(){var t={x:50,y:100};if(this.vertex&&this.nodeList.length&&this.linkList.length){this.vertex.depth=0;var e=At(this.vertex.center,2),n=e[0],i=e[1];this.insetGrouping().slice(1).reduce((function(e,i){var r=gt(i),o=Math.max.apply(Math,gt(r.map((function(t){return t.height})))),s=e+o/2+t.y,a=[],u=n;return a.push(u),r.reduce((function(e,n){return u+=Math.ceil(e.width/2+t.x+n.width/2),a.push(u),n})),r.forEach((function(t,e){var i=Math.ceil(a[e]-u/2+n/2);t.center=[i,s]})),e+o+t.y}),i+this.vertex.height/2)}}},{key:"horizontal",value:function(){var t={x:100,y:50};if(this.vertex&&this.nodeList.length&&this.linkList.length){this.vertex.depth=0;var e=At(this.vertex.center,2),n=e[0],i=e[1];this.insetGrouping(!0).slice(1).reduce((function(e,n){var r=gt(n),o=Math.max.apply(Math,gt(r.map((function(t){return t.width})))),s=e+o/2+t.x,a=[],u=i;return a.push(u),r.reduce((function(e,n){return u+=Math.ceil(e.height/2+t.y+n.height/2),a.push(u),n})),r.forEach((function(t,e){var n=Math.ceil(a[e]-u/2+i/2);t.center=[s,n]})),e+o+t.x}),n+this.vertex.width/2)}}},{key:"addNode",value:function(t){var e=t.constructor===et?t:this.createNode(t);this.nodeList.push(e)}},{key:"addLink",value:function(t){var e=t.constructor===vt?t:this.createLink(t),n=this.linkList.find((function(t){return t.start===e.start&&t.end===e.end}));n?(n.startAt=e.startAt,n.endAt=e.endAt):e.start&&e.end&&this.linkList.push(e)}},{key:"removeNode",value:function(t){var e=this,n=this.nodeList.indexOf(t);this.linkList.filter((function(e){return e.start===t||e.end===t})).forEach((function(t){e.removeLink(t)})),this.nodeList.splice(n,1)}},{key:"removeLink",value:function(t){var e=this.linkList.indexOf(t);this.linkList.splice(e,1),this.mouseonLink===t&&(this.mouseonLink=null)}},{key:"toLastNode",value:function(t){var e=this.nodeList;e.splice.apply(e,[e.length-1,0].concat(gt(e.splice(t,1))))}},{key:"toJSON",value:function(){return{width:this.width,height:this.height,origin:this.origin,nodeList:this.nodeList.map((function(t){return{id:t.id,width:t.width,height:t.height,vertex:t.vertex,coordinate:gt(t.coordinate),meta:t.meta}})),linkList:this.linkList.map((function(t){return{id:t.id,startId:t.start.id,endId:t.end.id,startAt:gt(t.startAt),endAt:gt(t.endAt),meta:t.meta}}))}}},{key:"selectAll",value:function(){var t=this.nodeList,e=20;this.maskBoundingClientRect={top:Math.min.apply(Math,gt(t.map((function(t){return t.center[1]-t.height/2}))))-e,right:Math.max.apply(Math,gt(t.map((function(t){return t.center[0]+t.width/2}))))+e,bottom:Math.max.apply(Math,gt(t.map((function(t){return t.center[1]+t.height/2}))))+e,left:Math.min.apply(Math,gt(t.map((function(t){return t.center[0]-t.width/2}))))-e},this.graphSelected=!0}},{key:"getInterface",value:function(){return{nodeList:this.nodeList.map((function(t){return t.getInterface()})),linkList:this.linkList.map((function(t){return t.getInterface()})),addNode:this.addNode.bind(this),addLink:this.addLink.bind(this),horizontal:this.horizontal.bind(this),vertical:this.vertical.bind(this),toJSON:this.toJSON.bind(this),selectAll:this.selectAll.bind(this)}}}]),n}(g),Ft=Rt,Xt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"flow__menu-mask",on:{mousemove:function(t){t.stopPropagation(),t.preventDefault()},mousedown:t.close}}),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"super-flow__menu",style:t.style,attrs:{tabindex:"-1"},on:{mousemove:function(t){t.stopPropagation(),t.preventDefault()},blur:t.close,contextmenu:function(t){t.preventDefault(),t.stopPropagation()}}},[t._l(t.list,(function(e){return[t._l(e,(function(e){return n("li",{staticClass:"super-flow__menu-item",class:{"is-disabled":e.disable},on:{click:function(n){return t.select(e)}}},[t._t("default",[n("span",{staticClass:"super-flow__menu-item-icon"}),n("span",{staticClass:"super-flow__menu-item-content"},[t._v(" "+t._s(e.label)+" ")])],{item:e})],2)})),n("li",{staticClass:"super-flow__menu-line"})]}))],2)])},Bt=[],Yt={props:{graph:Object,visible:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}},position:{type:Array,default:function(){return[0,0]}},source:{type:Object,default:function(){return{}}}},computed:{show:function(){},style:function(){return{left:this.position[0]+"px",top:this.position[1]+"px"}}},methods:{select:function(t){t.disable||(this.$emit("update:visible",!1),t.selected(this.source,D(this.position).minus(this.graph.origin).end))},close:function(t){this.$emit("update:visible",!1)}},watch:{visible:function(){var t=this;this.visible&&this.$nextTick((function(){return t.$el.focus()}))}}},Ut=Yt;n("b8fb");function Gt(t,e,n,i,r,o,s,a){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),s?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=u):r&&(u=a?function(){r.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:r),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(t,e){return u.call(e),l(t,e)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,u):[u]}return{exports:t,options:c}}var zt=Gt(Ut,Xt,Bt,!1,null,null,null),Ht=zt.exports,Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"super-flow__node",style:t.style,attrs:{tabindex:"-1"},on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.nodeMousedown(e)},mouseenter:t.nodeMouseenter,mouseleave:t.nodeMouseleave,mouseup:t.nodeMouseup,contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.nodeContextmenu(e)}}},[t._t("default",null,{meta:t.node.meta}),t._l(t.direction,(function(e,i){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.output,expression:"output"}],class:"node-side node-side-"+i,on:{contextmenu:function(t){t.stopPropagation(),t.preventDefault()},mousedown:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"left",37,n.key,["Left","ArrowLeft"])||"button"in n&&0!==n.button?null:(n.preventDefault(),n.stopPropagation(),function(n){return t.sideMousedown(n,e)}(n))}}})}))],2)},Vt=[],Wt={props:{graph:Object,node:Object,index:Number,isMove:Boolean,isTemEdge:Boolean,nodeIntercept:Function},data:function(){return{direction:G,output:this.nodeIntercept()}},computed:{style:function(){var t=this.node,e=t.position,n=t.width,i=t.height;return{width:n+"px",height:i+"px",top:e[1]+"px",left:e[0]+"px"}}},methods:{nodeMousedown:function(t){this.graph.toLastNode(this.index),this.$emit("node-mousedown",this.node,C(t))},nodeMouseenter:function(t){this.output=this.nodeIntercept(),this.graph.mouseonNode=this.node,this.isTemEdge&&this.$emit("node-mouseenter",t,this.node,C(t,this.$el))},nodeMouseleave:function(){this.graph.mouseonNode=null,this.isTemEdge&&this.$emit("node-mouseleave")},nodeMouseup:function(){this.isTemEdge&&this.$emit("node-mouseup")},nodeContextmenu:function(t){this.$emit("node-contextmenu",t,this.node)},sideMousedown:function(t){this.$emit("side-mousedown",t,this.node,C(t,this.$el))}}},qt=Wt,Kt=(n("2470"),Gt(qt,Jt,Vt,!1,null,null,null)),Qt=Kt.exports,Zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("canvas",{staticClass:"super-flow__line"})},te=[];function ee(t,e){return re(t)||ie(t,e)||ae(t,e)||ne()}function ne(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ie(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)if(n.push(s.value),e&&n.length===e)break}catch(u){r=!0,o=u}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function re(t){if(Array.isArray(t))return t}function oe(t){return ce(t)||ue(t)||ae(t)||se()}function se(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ae(t,e){if(t){if("string"===typeof t)return le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(t,e):void 0}}function ue(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ce(t){if(Array.isArray(t))return le(t)}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var he={props:{graph:Object,link:Object,padding:{type:Number,default:20}},data:function(){return{top:0,right:0,bottom:0,left:0,currentPointList:[]}},mounted:function(){this.ctx=this.$el.getContext("2d"),this.draw(),this.graph.add("mousemove",this.rootMousemove)},beforeDestroy:function(){this.graph.remove("mousemove",this.rootMousemove)},computed:{inPath:{get:function(){return this.graph.mouseonLink===this.link},set:function(t){t&&!this.graph.mouseonNode?(this.graph.mouseonLink=this.link,this.$el.style.zIndex=1):this.inPath&&(this.graph.mouseonLink=null,this.$el.style.zIndex=0)}}},methods:{draw:function(){var t=this,e=this.link.pathPointList,n=e.pointList,i=e.minX,r=e.minY,o=e.maxX,s=e.maxY;this.top=r-this.padding,this.right=o+this.padding,this.bottom=s+this.padding,this.left=i-this.padding,this.currentPointList=n.map((function(e){return[Math.floor(e[0]-t.left),Math.floor(e[1]-t.top)]})),this.changeStyle(),this.initLine()},changeStyle:function(){this.$el.width=this.right-this.left,this.$el.height=this.bottom-this.top,this.$el.style.top=this.top+"px",this.$el.style.left=this.left+"px"},initLine:function(){this.ctx.clearRect(0,0,this.$el.width,this.$el.height),this.inPath?(this.drawLine(2,"#FF0000"),this.drawArrow(4,"#FF0000")):(this.drawLine(),this.drawArrow())},drawLine:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#666666",n=this.ctx;n.beginPath(),n.lineWidth=t,n.strokeStyle=e,this.currentPointList.forEach((function(t,e){0===e?n.moveTo.apply(n,oe(t)):(n.lineTo.apply(n,oe(t)),n.stroke())})),n.save()},drawArrow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#666666",n=this.currentPointList.length;if(!(n<2)){var i=this.currentPointList[n-2],r=this.currentPointList[n-1],o=this.ctx;o.translate.apply(o,oe(r));var s=Math.atan((r[0]-i[0])/(r[1]-i[1]));o.beginPath(),r[1]-i[1]>=0?o.rotate(-s):o.rotate(Math.PI-s),o.fillStyle=e,o.lineTo(-t,2*-t),o.lineTo(0,-t),o.lineTo(t,2*-t),o.lineTo(0,0),o.closePath(),o.fill(),o.restore()}},getCoordinates:function(t){var e=t.clientX,n=t.clientY,i=this.$el.getBoundingClientRect(),r=i.top,o=i.left;return[e-o,n-r]},isPointInStroke:function(t){var e=this.getCoordinates(t),n=ee(e,2),i=n[0],r=n[1];return this.link.isPointInLink([this.left+i,this.top+r])},rootMousemove:function(t){var e=t.evt;return this.inPath=this.isPointInStroke(e),this.inPath}},watch:{"link.pathPointList":function(){this.draw()},inPath:function(){this.initLine()}}},fe=he,de=(n("7e2d"),Gt(fe,Zt,te,!1,null,null,null)),pe=de.exports;function me(t){return be(t)||ge(t)||ye(t)||ve()}function ve(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ye(t,e){if(t){if("string"===typeof t)return we(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(t,e):void 0}}function ge(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function be(t){if(Array.isArray(t))return we(t)}function we(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach((function(e){Me(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xe={name:"super-flow",props:{width:{type:Number,default:4e3},height:{type:Number,default:3e3},origin:{type:Array,default:function(){return[this.width/2,this.height/2]}},nodeList:{type:Array,default:function(){return[]}},linkList:{type:Array,default:function(){return[]}},graphMenu:{type:Array,default:function(){return[]}},nodeMenu:{type:Array,default:function(){return[]}},linkMenu:{type:Array,default:function(){return[]}},enterIntercept:{type:Function,default:function(){return!0}},outputIntercept:{type:Function,default:function(){return!0}}},data:function(){return{graph:new Ft({nodeList:this.pointList,linkList:this.edgeList,width:this.width,height:this.height,origin:this.origin}),menuConf:{visible:!1,position:[0,0],source:null,list:[]},moveNodeConf:{node:null,offset:null},moveAllConf:{isMove:!1,downPosition:[0,0]},temEdgeConf:{visible:!1,link:null},scorllCenterFun:Y(this.scrollCenter,200)}},components:{GraphMenu:Ht,GraphNode:Qt,GraphLine:pe},computed:{maskStyle:function(){var t=this.graph.maskBoundingClientRect,e=t.top,n=t.right,i=t.bottom,r=t.left;return{width:"".concat(n-r,"px"),height:"".concat(i-e,"px"),top:"".concat(e+this.graph.origin[1],"px"),left:"".concat(r+this.graph.origin[0],"px")}}},created:function(){this.graph.initNode(this.nodeList),this.graph.initLink(this.linkList)},mounted:function(){document.addEventListener("mouseup",this.docMouseup),document.addEventListener("mousemove",this.docMousemove),this.scrollCenter()},beforeDestroy:function(){document.removeEventListener("mouseup",this.docMouseup),document.removeEventListener("mousemove",this.docMousemove)},methods:{initMenu:function(t,e){return t.map((function(t){return t.map((function(t){var n,i;return n=F(t.disable)?t.disable(e):X(t.disable)?t.disable:Boolean(t.disable),i=F(t.hidden)?t.hidden(e):X(t.hidden)?t.hidden:Boolean(t.hidden),Ae(Ae({},t),{},{disable:n,hidden:i})})).filter((function(t){return!t.hidden}))})).filter((function(t){return t.length}))},showContextMenu:function(t,e,n){e.length&&(this.$set(this.menuConf,"position",t),this.$set(this.menuConf,"list",e),this.$set(this.menuConf,"source",n),this.menuConf.visible=!0)},docMouseup:function(){this.moveNodeConf.isMove=!1,this.moveNodeConf.node=null,this.moveNodeConf.offset=null,this.temEdgeConf.visible=!1,this.temEdgeConf.link=null,this.moveAllConf.isMove=!1},docMousemove:function(t){if(this.moveNodeConf.isMove)return this.moveNodeConf.node.position=D(this.moveNodeConf.offset).differ(C(t,this.$refs["flow-canvas"])).end;if(this.temEdgeConf.visible)return this.temEdgeConf.link.movePosition=C(t,this.$refs["flow-canvas"]);if(!this.graph.graphSelected)return this.graph.dispatch({type:"mousemove",evt:t},!0);if(this.moveAllConf.isMove){var e=D(this.moveAllConf.downPosition).differ([t.clientX,t.clientY]).end;this.graph.origin=D(this.moveAllConf.origin).add(e).end}else;},scrollCenter:function(){if(this.$el){var t=this.$el,e=t.clientHeight,n=t.clientWidth,i=t.scrollHeight,r=t.scrollWidth;this.$el.scrollLeft=Math.ceil((r-n)/2),this.$el.scrollTop=Math.ceil((i-e)/2)}},contextmenu:function(t){var e,n,i=this.graph.mouseonLink,r=C(t);if(i&&i.isPointInLink(r)){var o=i.getInterface();e=this.initMenu(this.linkMenu,o),n=o}else{i&&(this.graph.mouseonLink=null);var s=this.graph.getInterface();e=this.initMenu(this.graphMenu,s),n=s}this.showContextMenu(C(t,this.$refs["flow-canvas"]),e,n)},nodeMousedown:function(t,e){this.moveNodeConf.isMove=!0,this.moveNodeConf.node=t,this.moveNodeConf.offset=e},nodeMouseenter:function(t,e,n){var i=this.temEdgeConf.link;this.enterIntercept(i.start.getInterface(),e.getInterface(),this.graph.getInterface())&&(i.end=e,i.endAt=n)},nodeMouseleave:function(){this.temEdgeConf.link.end=null},nodeMouseup:function(){this.graph.addLink(this.temEdgeConf.link)},nodeContextmenu:function(t,e){e=e.getInterface();var n=this.initMenu(this.nodeMenu,e);n.length&&(this.$set(this.menuConf,"position",C(t,this.$refs["flow-canvas"])),this.$set(this.menuConf,"list",n),this.$set(this.menuConf,"source",e),this.menuConf.visible=!0)},sideMousedown:function(t,e,n){var i=this.graph.createLink({start:e,startAt:n});i.movePosition=C(t,this.$refs["flow-canvas"]),this.$set(this.temEdgeConf,"link",i),this.temEdgeConf.visible=!0},nodeIntercept:function(t){var e=this;return function(){return e.outputIntercept(t.getInterface(),e.graph.getInterface())}},menuItemSelect:function(){this.menuConf.visible=!1},selectAllMaskMouseDown:function(t){this.moveAllConf.isMove=!0,this.moveAllConf.origin=me(this.graph.origin),this.moveAllConf.downPosition=[t.clientX,t.clientY]},selectedAll:function(){this.graph.selectAll()},toJSON:function(){return this.graph.toJSON()}},watch:{"graph.graphSelected":function(){var t=this;this.graph.graphSelected&&this.$nextTick((function(){t.$refs.selectAllMask.focus()}))},"graph.mouseonLink":function(){this.graph.mouseonLink?document.body.style.cursor="pointer":document.body.style.cursor=""},nodeList:function(){this.graph.initNode(this.nodeList)},linkList:function(){this.graph.initLink(this.linkList)},width:function(){this.scorllCenterFun()},height:function(){this.scorllCenterFun()},origin:function(){this.scorllCenterFun()}},install:function(t){t.component(this.name,this)}},Le=xe,Ce=(n("3ad9"),Gt(Le,s,a,!1,null,null,null)),Se=Ce.exports;e["default"]=Se}})["default"]}));